<!DOCTYPE html>
<html>
<head>
    <title>Checkers Game</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Checkers Game</h1>
        
        <div style="background: #e3f2fd; padding: 15px; margin: 20px 0; border-radius: 10px; border: 2px solid #2196F3;">
            <h2 style="margin: 0 0 10px 0;">Room Code: <span style="color: #2196F3; font-size: 28px;">{{ room_code }}</span></h2>
            <p style="margin: 5px 0;">Share this code with your friend to play together!</p>
            <p style="margin: 5px 0;"><strong>You are: <span style="color: {% if player_color == 'green' %}#228B22{% else %}#333{% endif %};">{{ player_color|upper }}</span></strong></p>
        </div>
        
        <div class="game-status">
            <div class="scores">
                <span class="player-green">Green: {{ green_score }}</span> | 
                <span class="player-white">White: {{ white_score }}</span>
            </div>
            
            {% if winner %}
                <h2 class="winner">{{ winner.upper() }} Wins!</h2>
                <p>Game Over - <a href="{{ url_for('reset_room', room=room_code) }}">Start New Game</a></p>
            {% else %}
                <h2>Current Player: 
                    <span class="player-{{ current_player }}">{{ current_player|upper }}</span>
                </h2>
                {% if selected %}
                    <p>Selected piece at: Row {{ selected[0] + 1 }}, Col {{ selected[1] + 1 }}</p>
                {% else %}
                    <p>{% if player_color == current_player %}Your turn!{% else %}Waiting for opponent...{% endif %}</p>
                {% endif %}
            {% endif %}
        </div>

        <div class="board">
            {% for row_index in range(8) %}
                <div class="board-row">
                    {% for col_index in range(8) %}
                        {% set square_color = 'light' if (row_index + col_index) % 2 == 0 else 'dark' %}
                        {% set is_selected = selected and selected[0] == row_index and selected[1] == col_index %}
                        
                        <div class="square {{ square_color }} {% if is_selected %}selected{% endif %}" 
                             {% if not winner %}onclick="location.href='{{ url_for('move', room=room_code, row=row_index, col=col_index) }}'"{% endif %}>
                            
                            {% if board[row_index][col_index] %}
                                {% set piece = board[row_index][col_index] %}
                                <div class="piece {{ piece.color }} {% if piece.king %}king{% endif %}">
                                    {% if piece.king %}♔{% else %}●{% endif %}
                                </div>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            {% endfor %}
        </div>

        <div class="controls">
            <a href="{{ url_for('reset_room', room=room_code) }}" class="btn">Reset Game</a>
            <a href="{{ url_for('new_game') }}" class="btn">New Room</a>
            <a href="{{ url_for('index') }}" class="btn">Home</a>
        </div>
    </div>
    
    <script>
        // Auto-refresh every 2 seconds to see opponent's moves
        {% if not winner and player_color != current_player %}
        setTimeout(function() {
            location.reload();
        }, 2000);
        {% endif %}
    </script>
</body>
</html>
